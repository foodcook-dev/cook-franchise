var ve=t=>{throw TypeError(t)};var ee=(t,e,s)=>e.has(t)||ve("Cannot "+s);var r=(t,e,s)=>(ee(t,e,"read from private field"),s?s.call(t):e.get(t)),x=(t,e,s)=>e.has(t)?ve("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),b=(t,e,s,n)=>(ee(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s),S=(t,e,s)=>(ee(t,e,"access private method"),s);import{K as Ue,N as ye,Q as _,T as se,U as q,V as Me,W as re,X as be,Y as Pe,Z as ke,_ as De,$ as Se,a0 as Te,r as j,a1 as Ne,a2 as Le,k as He,j as p,B as Ae,t as Be}from"./index-DDD4eibi.js";import{A as $e,b as We}from"./avatar-DPLuqSLl.js";import{D as Je,a as ze,b as Ke,c as Ve,d as Ge,e as Xe}from"./dropdown-menu-CJZvIE4g.js";import{b as Ye,A as fe}from"./user-auth-DqR-jit0.js";import{I as Ze}from"./IconUser-DosRSd1O.js";import{S as Re,a as xe,b as te,c as Ce,d as we,e as Z}from"./select-C38Xiz44.js";var I,l,K,w,D,A,U,M,V,B,$,N,L,P,W,d,J,ne,ie,ae,oe,ce,le,he,Qe,Fe,It=(Fe=class extends Ue{constructor(e,s){super();x(this,d);x(this,I);x(this,l);x(this,K);x(this,w);x(this,D);x(this,A);x(this,U);x(this,M);x(this,V);x(this,B);x(this,$);x(this,N);x(this,L);x(this,P);x(this,W,new Set);this.options=s,b(this,I,e),b(this,M,null),b(this,U,ye()),this.options.experimental_prefetchInRender||r(this,U).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,l).addObserver(this),Ie(r(this,l),this.options)?S(this,d,J).call(this):this.updateResult(),S(this,d,oe).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ue(r(this,l),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ue(r(this,l),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,S(this,d,ce).call(this),S(this,d,le).call(this),r(this,l).removeObserver(this)}setOptions(e){const s=this.options,n=r(this,l);if(this.options=r(this,I).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof _(this.options.enabled,r(this,l))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");S(this,d,he).call(this),r(this,l).setOptions(this.options),s._defaulted&&!se(this.options,s)&&r(this,I).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,l),observer:this});const o=this.hasListeners();o&&je(r(this,l),n,this.options,s)&&S(this,d,J).call(this),this.updateResult(),o&&(r(this,l)!==n||_(this.options.enabled,r(this,l))!==_(s.enabled,r(this,l))||q(this.options.staleTime,r(this,l))!==q(s.staleTime,r(this,l)))&&S(this,d,ne).call(this);const a=S(this,d,ie).call(this);o&&(r(this,l)!==n||_(this.options.enabled,r(this,l))!==_(s.enabled,r(this,l))||a!==r(this,P))&&S(this,d,ae).call(this,a)}getOptimisticResult(e){const s=r(this,I).getQueryCache().build(r(this,I),e),n=this.createResult(s,e);return et(this,n)&&(b(this,w,n),b(this,A,this.options),b(this,D,r(this,l).state)),n}getCurrentResult(){return r(this,w)}trackResult(e,s){const n={};return Object.keys(e).forEach(o=>{Object.defineProperty(n,o,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(o),s==null||s(o),e[o])})}),n}trackProp(e){r(this,W).add(e)}getCurrentQuery(){return r(this,l)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=r(this,I).defaultQueryOptions(e),n=r(this,I).getQueryCache().build(r(this,I),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(e){return S(this,d,J).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,w)))}createResult(e,s){var ge;const n=r(this,l),o=this.options,a=r(this,w),c=r(this,D),R=r(this,A),v=e!==n?e.state:r(this,K),{state:C}=e;let m={...C},O=!1,f;if(s._optimisticResults){const F=this.hasListeners(),X=!F&&Ie(e,s),H=F&&je(e,n,s,o);(X||H)&&(m={...m,...De(C.data,e.options)}),s._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:T,errorUpdatedAt:i,status:u}=m;f=m.data;let y=!1;if(s.placeholderData!==void 0&&f===void 0&&u==="pending"){let F;a!=null&&a.isPlaceholderData&&s.placeholderData===(R==null?void 0:R.placeholderData)?(F=a.data,y=!0):F=typeof s.placeholderData=="function"?s.placeholderData((ge=r(this,$))==null?void 0:ge.state.data,r(this,$)):s.placeholderData,F!==void 0&&(u="success",f=Se(a==null?void 0:a.data,F,s),O=!0)}if(s.select&&f!==void 0&&!y)if(a&&f===(c==null?void 0:c.data)&&s.select===r(this,V))f=r(this,B);else try{b(this,V,s.select),f=s.select(f),f=Se(a==null?void 0:a.data,f,s),b(this,B,f),b(this,M,null)}catch(F){b(this,M,F)}r(this,M)&&(T=r(this,M),f=r(this,B),i=Date.now(),u="error");const g=m.fetchStatus==="fetching",E=u==="pending",k=u==="error",G=E&&g,me=f!==void 0,Q={status:u,fetchStatus:m.fetchStatus,isPending:E,isSuccess:u==="success",isError:k,isInitialLoading:G,isLoading:G,data:f,dataUpdatedAt:m.dataUpdatedAt,error:T,errorUpdatedAt:i,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>v.dataUpdateCount||m.errorUpdateCount>v.errorUpdateCount,isFetching:g,isRefetching:g&&!E,isLoadingError:k&&!me,isPaused:m.fetchStatus==="paused",isPlaceholderData:O,isRefetchError:k&&me,isStale:pe(e,s),refetch:this.refetch,promise:r(this,U)};if(this.options.experimental_prefetchInRender){const F=Y=>{Q.status==="error"?Y.reject(Q.error):Q.data!==void 0&&Y.resolve(Q.data)},X=()=>{const Y=b(this,U,Q.promise=ye());F(Y)},H=r(this,U);switch(H.status){case"pending":e.queryHash===n.queryHash&&F(H);break;case"fulfilled":(Q.status==="error"||Q.data!==H.value)&&X();break;case"rejected":(Q.status!=="error"||Q.error!==H.reason)&&X();break}}return Q}updateResult(){const e=r(this,w),s=this.createResult(r(this,l),this.options);if(b(this,D,r(this,l).state),b(this,A,this.options),r(this,D).data!==void 0&&b(this,$,r(this,l)),se(s,e))return;b(this,w,s);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:o}=this.options,a=typeof o=="function"?o():o;if(a==="all"||!a&&!r(this,W).size)return!0;const c=new Set(a??r(this,W));return this.options.throwOnError&&c.add("error"),Object.keys(r(this,w)).some(R=>{const h=R;return r(this,w)[h]!==e[h]&&c.has(h)})};S(this,d,Qe).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&S(this,d,oe).call(this)}},I=new WeakMap,l=new WeakMap,K=new WeakMap,w=new WeakMap,D=new WeakMap,A=new WeakMap,U=new WeakMap,M=new WeakMap,V=new WeakMap,B=new WeakMap,$=new WeakMap,N=new WeakMap,L=new WeakMap,P=new WeakMap,W=new WeakMap,d=new WeakSet,J=function(e){S(this,d,he).call(this);let s=r(this,l).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(Me)),s},ne=function(){S(this,d,ce).call(this);const e=q(this.options.staleTime,r(this,l));if(re||r(this,w).isStale||!be(e))return;const n=Pe(r(this,w).dataUpdatedAt,e)+1;b(this,N,setTimeout(()=>{r(this,w).isStale||this.updateResult()},n))},ie=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,l)):this.options.refetchInterval)??!1},ae=function(e){S(this,d,le).call(this),b(this,P,e),!(re||_(this.options.enabled,r(this,l))===!1||!be(r(this,P))||r(this,P)===0)&&b(this,L,setInterval(()=>{(this.options.refetchIntervalInBackground||ke.isFocused())&&S(this,d,J).call(this)},r(this,P)))},oe=function(){S(this,d,ne).call(this),S(this,d,ae).call(this,S(this,d,ie).call(this))},ce=function(){r(this,N)&&(clearTimeout(r(this,N)),b(this,N,void 0))},le=function(){r(this,L)&&(clearInterval(r(this,L)),b(this,L,void 0))},he=function(){const e=r(this,I).getQueryCache().build(r(this,I),this.options);if(e===r(this,l))return;const s=r(this,l);b(this,l,e),b(this,K,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},Qe=function(e){Te.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(r(this,w))}),r(this,I).getQueryCache().notify({query:r(this,l),type:"observerResultsUpdated"})})},Fe);function qe(t,e){return _(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Ie(t,e){return qe(t,e)||t.state.data!==void 0&&ue(t,e,e.refetchOnMount)}function ue(t,e,s){if(_(e.enabled,t)!==!1){const n=typeof s=="function"?s(t):s;return n==="always"||n!==!1&&pe(t,e)}return!1}function je(t,e,s,n){return(t!==e||_(n.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&pe(t,s)}function pe(t,e){return _(e.enabled,t)!==!1&&t.isStaleByTime(q(e.staleTime,t))}function et(t,e){return!se(t.getCurrentResult(),e)}var _e=j.createContext(!1),tt=()=>j.useContext(_e);_e.Provider;function st(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var rt=j.createContext(st()),nt=()=>j.useContext(rt);function it(t,e){return typeof t=="function"?t(...e):!!t}function Oe(){}var at=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},ot=t=>{j.useEffect(()=>{t.clearReset()},[t])},ct=({result:t,errorResetBoundary:e,throwOnError:s,query:n,suspense:o})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(o&&t.data===void 0||it(s,[t.error,n])),lt=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...s)=>Math.max(e(...s),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},ht=(t,e)=>t.isLoading&&t.isFetching&&!e,ut=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Ee=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function jt(t,e,s){var m,O,f,T,i;const n=Ne(),o=tt(),a=nt(),c=n.defaultQueryOptions(t);(O=(m=n.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||O.call(m,c),c._optimisticResults=o?"isRestoring":"optimistic",lt(c),at(c,a),ot(a);const R=!n.getQueryCache().get(c.queryHash),[h]=j.useState(()=>new e(n,c)),v=h.getOptimisticResult(c),C=!o&&t.subscribed!==!1;if(j.useSyncExternalStore(j.useCallback(u=>{const y=C?h.subscribe(Te.batchCalls(u)):Oe;return h.updateResult(),y},[h,C]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),j.useEffect(()=>{h.setOptions(c)},[c,h]),ut(c,v))throw Ee(c,h,a);if(ct({result:v,errorResetBoundary:a,throwOnError:c.throwOnError,query:n.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw v.error;if((T=(f=n.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||T.call(f,c,v),c.experimental_prefetchInRender&&!re&&ht(v,o)){const u=R?Ee(c,h,a):(i=n.getQueryCache().get(c.queryHash))==null?void 0:i.promise;u==null||u.catch(Oe).finally(()=>{h.updateResult()})}return c.notifyOnChangeProps?v:h.trackResult(v)}function dt(t,e){let s;try{s=t()}catch{return}return{getItem:o=>{var a;const c=h=>h===null?null:JSON.parse(h,void 0),R=(a=s.getItem(o))!=null?a:null;return R instanceof Promise?R.then(c):c(R)},setItem:(o,a)=>s.setItem(o,JSON.stringify(a,void 0)),removeItem:o=>s.removeItem(o)}}const de=t=>e=>{try{const s=t(e);return s instanceof Promise?s:{then(n){return de(n)(s)},catch(n){return this}}}catch(s){return{then(n){return this},catch(n){return de(n)(s)}}}},ft=(t,e)=>(s,n,o)=>{let a={storage:dt(()=>localStorage),partialize:i=>i,version:0,merge:(i,u)=>({...u,...i}),...e},c=!1;const R=new Set,h=new Set;let v=a.storage;if(!v)return t((...i)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...i)},n,o);const C=()=>{const i=a.partialize({...n()});return v.setItem(a.name,{state:i,version:a.version})},m=o.setState;o.setState=(i,u)=>{m(i,u),C()};const O=t((...i)=>{s(...i),C()},n,o);o.getInitialState=()=>O;let f;const T=()=>{var i,u;if(!v)return;c=!1,R.forEach(g=>{var E;return g((E=n())!=null?E:O)});const y=((u=a.onRehydrateStorage)==null?void 0:u.call(a,(i=n())!=null?i:O))||void 0;return de(v.getItem.bind(v))(a.name).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==a.version){if(a.migrate){const E=a.migrate(g.state,g.version);return E instanceof Promise?E.then(k=>[!0,k]):[!0,E]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,g.state];return[!1,void 0]}).then(g=>{var E;const[k,G]=g;if(f=a.merge(G,(E=n())!=null?E:O),s(f,!0),k)return C()}).then(()=>{y==null||y(f,void 0),f=n(),c=!0,h.forEach(g=>g(f))}).catch(g=>{y==null||y(void 0,g)})};return o.persist={setOptions:i=>{a={...a,...i},i.storage&&(v=i.storage)},clearStorage:()=>{v==null||v.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>T(),hasHydrated:()=>c,onHydrate:i=>(R.add(i),()=>{R.delete(i)}),onFinishHydration:i=>(h.add(i),()=>{h.delete(i)})},a.skipHydration||T(),f||O},pt=ft,z=Le()(pt(t=>({selectedFranchise:null,selectedStore:null,setSelectedFranchise:e=>t({selectedFranchise:e}),setSelectedStore:e=>t({selectedStore:e}),reset:()=>t({selectedFranchise:null,selectedStore:null})}),{name:"franchise-selected-values"}));function Ot({userInfo:t}){const e=He.useTranslations("userNav"),s=z.getState();return p.jsxs(Je,{children:[p.jsx(ze,{asChild:!0,children:p.jsx(Ae,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:p.jsx($e,{className:"h-8 w-8",children:p.jsx(We,{children:p.jsx(Ze,{size:18})})})})}),p.jsxs(Ke,{className:"w-56",align:"end",forceMount:!0,children:[p.jsx(Ve,{className:"font-normal",children:p.jsx("div",{className:"flex flex-col space-y-1",children:p.jsx("p",{className:"text-sm font-medium leading-none",children:t==null?void 0:t.username})})}),p.jsx(Ge,{}),p.jsx(Xe,{onClick:async()=>{await Ye(),s.reset(),sessionStorage.removeItem("franchise-selected-values"),window.location.reload()},children:e("log_out")})]})]})}const mt=async()=>{const t=await fe.get("/franchise/franchises/");return t.data?t.data:null},gt=async t=>{const e=await fe.get(`/franchise/franchises/${t}/sales-companies/`);return e.data?e.data:null},Et=async({page:t=1,franchise_id:e,search:s})=>{let n=`&franchise_id=${e}`;return s&&(n+=`&search_keyword=${s}`),(await fe.get(`/product/get-stock-management/?page=${t}${n}`)).data};function Ft({isAllSelected:t=!0,storeShow:e=!0,handleSubmitDate:s}){const{toast:n}=Be(),[o,a]=j.useState([]),[c,R]=j.useState([]),h=z(i=>i.selectedFranchise),v=z(i=>i.setSelectedFranchise),C=z(i=>i.selectedStore),m=z(i=>i.setSelectedStore),O=async()=>{var i,u;try{const y=await mt();y&&a(y==null?void 0:y.franchises)}catch(y){const g=y;console.error("에러:",(i=g==null?void 0:g.response)==null?void 0:i.data.detail),n({variant:"destructive",description:(u=g==null?void 0:g.response)==null?void 0:u.data.detail})}},f=async i=>{if(i==="all"){v(null),R([]),m(null),s&&s({franchiseId:"all",storeInfo:null});return}const u=o==null?void 0:o.find(g=>g.id.toString()===i);u&&(v(u),m(null),s&&s({franchiseId:i,storeInfo:null}));const y=await gt(i);y&&R(y==null?void 0:y.sales_companies)},T=async i=>{if(i==="all"){m(null),s&&s({franchiseId:h==null?void 0:h.id,storeInfo:{id:"all",name:"전체"}});return}const u=c==null?void 0:c.find(y=>y.id.toString()===i);u&&(m(u),s&&s({storeInfo:u}))};return j.useEffect(()=>{O()},[]),j.useEffect(()=>{h&&f(h.id.toString())},[]),j.useEffect(()=>{C&&T(C.id.toString())},[]),p.jsxs(p.Fragment,{children:[p.jsxs(Re,{onValueChange:f,value:(h==null?void 0:h.id.toString())??"",children:[p.jsx(xe,{className:`${t?"w-[180px]":"w-[200px]"} `,children:t?p.jsx(te,{placeholder:"프랜차이즈 선택"}):p.jsx(te,{placeholder:"프랜차이즈를 선택해주세요"})}),p.jsx(Ce,{children:p.jsxs(we,{children:[p.jsx(Z,{value:"all",children:t?"전체":"선택"},"all"),o==null?void 0:o.map(i=>p.jsx(Z,{value:i.id.toString(),children:i.name},i.id))]})})]}),e&&p.jsxs(Re,{onValueChange:T,value:(C==null?void 0:C.id.toString())??"",children:[p.jsx(xe,{className:"w-[180px]",children:p.jsx(te,{placeholder:"가맹점 선택"})}),p.jsx(Ce,{children:p.jsxs(we,{children:[p.jsx(Z,{value:"all",children:"전체"},"all"),c==null?void 0:c.map(i=>p.jsx(Z,{value:i.id.toString(),children:i.name},i.id))]})})]})]})}export{Ft as F,It as Q,Ot as U,z as a,Et as g,jt as u};
